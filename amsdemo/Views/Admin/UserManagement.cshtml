
@{
    ViewBag.Title = "User Management";
}

<div class="ibox">

    <div class="ibox-body">
        <ul class="nav nav-pills">
            <li class="nav-item">
                <a class="nav-link active" href="#pill-1-1" data-toggle="tab">Create Users</a>
            </li>
            <li class="nav-item">
                <a class="nav-link " href="#pill-1-2" data-toggle="tab">View Users</a>
            </li>
            <li class="nav-item">
                <a class="nav-link " href="#pill-1-3" data-toggle="tab">Assign Roles to Users</a>
            </li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane show active" id="pill-1-1">
                @Html.Partial("CreateUserPartial")
            </div>
            <div class="tab-pane" id="pill-1-2">
                @Html.Partial("AssignrolesPartial")
            </div>
            <div class="tab-pane" id="pill-1-3">

            </div>

        </div>
    </div>
</div>
@section scripts{

    <script>
       $(function () {
            var successMessage = '@TempData["SuccessMessage1"]'
            if (successMessage != '')
                alertify.success(successMessage);
        });
    </script>
    <script>
        $(function () {
            var errorMessage = '@TempData["ErrorMessage1"]'
            if (errorMessage != '')
                alertify.error(errorMessage);
        });
    </script>

    <script type="text/javascript">
        var Popup, dataTable;
        $(function () {
            $('#example').DataTable({
                pageLength: 5,
                "ajax": {
                    "url": '/admin/GetEmployeeList',
                    "type": "get",
                    "datatype": "json"
                },
                "columns": [

                    { "data": "EmployeeId", "authowidth": false },
                    { "data": "EmployeeName", "authowidth": false },
                    { "data": "DepartmentId", "authowidth": false },
                    { "data": "DepartmentName", "authowidth": false }

                ]
            });

        });
        document.getElementById('example').onclick = function (event) {
            event = event || window.event;
            var target = event.target || event.srcElement;
            while (target && target.nodeName != 'TR') {
                target = target.parentElement;
            }
            var cells = target.cells;
            if (!cells.length || target.parentNode.nodeName == 'THEAD') {
                return;
            }
            //alert(cells[1].innerHTML);
            $(function () {
                $('#getempId').val($.trim(cells[0].innerHTML));
                $('#getUsername').val($.trim(cells[1].innerHTML));
                $('#getdepId').val($.trim(cells[2].innerHTML));
                $('#myModal').modal('hide');

            });



            //focuses cursor on username field
            document.getElementById('getUsername').focus();


        }


    </script>

    <script type="text/javascript">
        var Popup, dataTable;
        $(function () {
            $('#usertable').DataTable({
                pageLength: 5,
                "ajax": {
                    "url": '/admin/UserforroleList',
                    "type": "get",
                    "datatype": "json"
                },
                "columns": [

                    { "data": "UserId", "authowidth": false },
                    { "data": "UserName", "authowidth": false },
                    { "data": "Position", "authowidth": false },
                    { "data": "DepartmentName", "authowidth": false }

                ]
            });

        });
        document.getElementById('usertable').onclick = function (event) {
            event = event || window.event;
            var target = event.target || event.srcElement;
            while (target && target.nodeName != 'TR') {
                target = target.parentElement;
            }
            var cells = target.cells;
            if (!cells.length || target.parentNode.nodeName == 'THEAD') {
                return;
            }
            //alert(cells[1].innerHTML);
            $(function () {
                $('#getUserId').val($.trim(cells[0].innerHTML));
                $('#getUserName').val($.trim(cells[1].innerHTML));
                $('#getposition').val($.trim(cells[2].innerHTML));
                $('#getdepname').val($.trim(cells[3].innerHTML));

                $('#myModaluser').modal('hide');

            });


            //focuses cursor on username field
            document.getElementById('getposition').focus();


        }


    </script>







}